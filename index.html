<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1, user-scalable=no"
  />
  <meta name="theme-color" content="#0b1020" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>是々日々 — 日記 / 予定 / 検索 / 調整</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />
  <!-- アイコン（GitHubの /ICONS 配下を想定）-->
  <link rel="icon" sizes="192x192" href="ICONS/icon-192.png" />
  <link rel="icon" sizes="512x512" href="ICONS/icon-512.png" />
  <link rel="apple-touch-icon" href="ICONS/icon-512.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <noscript>このアプリを利用するにはJavaScriptを有効にしてください。</noscript>

  <div class="app-root">
    <!-- ヘッダー -->
    <header class="top-bar" aria-label="ヘッダー">
      <div class="top-title">膳是々日々</div>
      <div id="todayBadge" class="top-today" aria-live="polite"></div>
    </header>

    <!-- メイン -->
    <main class="main-area" id="main">
      <!-- ===== ① 日記（カレンダー全面） ===== -->
      <section id="screenDiary" class="screen screen-active" role="tabpanel" aria-label="日記">
        <div class="month-header">
          <button id="prevM" class="nav-btn" type="button" aria-label="前の月">‹</button>
          <div id="monthLabel" class="month-label">—</div>
          <button id="nextM" class="nav-btn" type="button" aria-label="次の月">›</button>
        </div>

        <div class="weekday-row" aria-hidden="true">
          <div class="wd sun">日</div><div class="wd">月</div><div class="wd">火</div>
          <div class="wd">水</div><div class="wd">木</div><div class="wd">金</div><div class="wd sat">土</div>
        </div>

        <!-- ★ カレンダー全面（下に何も置かない） -->
        <div id="calGrid" class="calendar-grid" aria-label="カレンダー（ダブルタップ/ダブルクリックで編集）"></div>

        <!-- 選択日のバッジ（必要最低限だけ残す。高さはCSSで最小化） -->
        <div class="day-summary" id="daySummary" aria-live="polite">
          <span class="badge" id="selISO">—</span>
          <span id="selJP">—</span>
          <span class="badge" style="margin-left:auto;">ダブルタップ/ダブルクリックで編集</span>
        </div>
      </section>

      <!-- ===== ② 予定（簡易月＋日別リスト） ===== -->
      <section id="screenSched" class="screen" role="tabpanel" aria-label="予定" hidden>
        <div class="month-header">
          <button id="sPrevM" class="nav-btn" type="button" aria-label="前の月">‹</button>
          <div id="schedMonthLabel" class="month-label">—</div>
          <button id="sNextM" class="nav-btn" type="button" aria-label="次の月">›</button>
        </div>

        <div class="weekday-row" aria-hidden="true">
          <div class="wd sun">日</div><div class="wd">月</div><div class="wd">火</div>
          <div class="wd">水</div><div class="wd">木</div><div class="wd">金</div><div class="wd sat">土</div>
        </div>

        <div id="schedGrid" class="calendar-grid" aria-label="予定カレンダー"></div>

        <div class="section-header">
          <h2>当日の予定</h2>
          <div id="schedKPI" class="badge">—</div>
        </div>
        <div id="schedList" class="card-list"></div>
      </section>

      <!-- ===== ③ 検索 ===== -->
      <section id="screenSearch" class="screen" role="tabpanel" aria-label="検索" hidden>
        <div class="section-header">
          <h2>検索</h2>
        </div>
        <div class="search-panel">
          <input id="q" class="search-input" type="text" placeholder="キーワード（タイトル・本文・食事・予定など）" />
        </div>
        <div class="search-grid">
          <div>
            <div class="sub-heading">日記</div>
            <div id="searchDiary" class="card-list"></div>
          </div>
          <div>
            <div class="sub-heading">予定</div>
            <div id="searchSched" class="card-list"></div>
          </div>
        </div>
      </section>

      <!-- ===== ④ 調整（簡易） ===== -->
      <section id="screenCoord" class="screen" role="tabpanel" aria-label="スケジュール調整" hidden>
        <div class="coord-header">
          <span class="badge">調整用（簡易表示）</span>
        </div>
        <div class="bands-list" id="coordList">
          <div class="band-row">
            <span>空き候補は予定の重なりから算出（app.jsで実装）</span>
            <span class="badge">β</span>
          </div>
        </div>
      </section>

      <!-- ===== ⑤ エディタ（別画面に統合） ===== -->
      <section id="screenEditor" class="screen" role="dialog" aria-label="日記エディタ" hidden>
        <dialog id="editorDlg" class="modal" open>
          <div class="modal-body">
            <div class="section-header">
              <h2 style="font-size:13px;margin:0">日記エディタ</h2>
              <button id="backToCalendar" class="sub-btn" type="button">カレンダーへ戻る</button>
            </div>

            <div class="grid-2">
              <div class="field-label">
                <span>日付</span>
                <input id="dateInput" type="date" />
              </div>
              <div class="field-label">
                <span>起床</span>
                <input id="wake" type="time" />
              </div>
            </div>

            <div class="grid-3">
              <div class="field-label">
                <span>朝食</span>
                <input id="breakfast" type="text" placeholder="例：パンと卵" />
              </div>
              <div class="field-label">
                <span>昼食</span>
                <input id="lunch" type="text" placeholder="例：親子丼" />
              </div>
              <div class="field-label">
                <span>夕食</span>
                <input id="dinner" type="text" placeholder="例：カレー" />
              </div>
            </div>

            <div class="field-label">
              <span>タイトル</span>
              <input id="title" type="text" placeholder="タイトル" />
            </div>

            <div class="field-label">
              <span>本文</span>
              <textarea id="body" rows="8" placeholder="本文"></textarea>
            </div>

            <div class="modal-actions">
              <span class="badge" id="editISO">—</span>
              <span id="editJP" style="font-size:10px;color:var(--text-sub)">—</span>
              <div class="flex-spacer"></div>
              <small id="saveState" class="card-sub">—</small>
              <button id="deleteEntry" class="danger-btn" type="button">削除</button>
              <button id="saveEntry" class="primary-btn" type="button">保存</button>
            </div>
          </div>
        </dialog>
      </section>
    </main>

    <!-- タブバー（ホームバー回避で少し浮かせる） -->
    <nav class="tab-bar" role="tablist" aria-label="メインタブ">
      <button id="tabDiary" class="tab-btn tab-active" aria-controls="screenDiary" aria-selected="true">日記</button>
      <button id="tabSched" class="tab-btn" aria-controls="screenSched" aria-selected="false">予定</button>
      <button id="tabSearch" class="tab-btn" aria-controls="screenSearch" aria-selected="false">検索</button>
      <button id="tabCoord" class="tab-btn" aria-controls="screenCoord" aria-selected="false">調整</button>
    </nav>

    <!-- iPhoneホームバーとの重なり防止のための下余白 -->
    <div style="height: calc(env(safe-area-inset-bottom, 0px) + 64px)"></div>
  </div>

  <!-- App -->
  <script defer src="app.js"></script>
</body>
</html>
